# MCP数据库查询系统实验要求

## 项目概述
基于大语言模型与MCP协议的自然语言数据库查询系统，集成通义千问API实现自然语言到SQL的转换。

## 技术架构
- **MCP Server**: 数据库连接和查询执行
- **LLM API**: 自然语言到SQL转换  
- **CLI/GUI**: 用户交互界面
- **安全模块**: SQL注入防护和权限控制

## 评分标准

### 基础功能 (60-70分)
| 任务 | 分值 | 要求说明 |
|------|------|----------|
| MCP服务配置 | 10分 | 部署alexcc4/mcp-mysql-server，连接MySQL |
| 大模型API调用 | 15分 | 通义千问API集成，自然语言→SQL转换 |
| SQL查询准确性 | 20分 | 基础查询功能，返回JSON结果 |
| CLI界面 | 10分 | 终端交互，自然语言输入输出 |
| 测试用例 | 15分 | 至少5个测试案例及结果分析 |
| 项目报告 | 10分 | 完整的文档和代码说明 |

### 功能增强 (加分20分)
- **查询日志**: `/logs`端点记录SQL执行历史和时间戳
- **结果分页**: 支持`next`命令或自动分页显示长查询结果  
- **表结构过滤**: `/schema`支持按表名过滤返回结构信息

### 安全控制 (加分20分)
- **SQL白名单**: 仅允许SELECT语句执行
- **字段访问控制**: 禁止查询敏感字段(password、salary等)
- **注入防护**: 拦截SQL注入攻击模式

### 高级优化 (加分20分)
- **Prompt优化**: 提升SQL生成准确率≥10%
- **多轮对话**: Few-shot示例和上下文优化
- **性能建议**: SQL执行计划优化建议
- **GUI界面**: Streamlit等可视化界面

## 测试用例
使用college数据库，包含以下标准测试：

1. **简单查询**: 按标题和学分排序的所有课程名称
2. **中等复杂**: 超过一个先修课程的课程信息  
3. **复杂关联**: 有多个导师的学生姓名
4. **高级筛选**: 无先修课程的课程标题